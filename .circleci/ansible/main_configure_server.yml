---
- name: 'install node-exporter.'
  hosts: EC2
  user: ubuntu
  become: true
  become_method: sudo
  become_user: root
  gather_facts: false
  vars:
    - ansible_python_interpreter: /usr/bin/python3
    - ansible_host_key_checking: false
    - ansible_stdout_callback: yaml
  roles:
    - prometheus_node_exporter

# - name: install node-exporter
#   hosts: EC2
#   become: yes
#   roles:
#   - prometheus_node_exporter

# - name: "configuration play."
#   # hosts: ubuntu
#   # Use the public IP if the VM is already created
#   hosts: EC2
#   user: ubuntu
#   become: true
#   become_method: sudo
#   become_user: ubuntu
#   # gather_facts: false
#   # vars:
#   #   - ansible_python_interpreter: /usr/bin/python3
#   #   - ansible_host_key_checking: false
#   #   - ansible_stdout_callback: yaml

#   # pre_tasks:
#   #   - name: "wait 100 seconds for target connection to become reachable/usable."
#   #     wait_for_connection:
#   #       delay: 10
#   #       timeout: 100    

#   #   - name: "install python for Ansible."
#   #     #installing python for Ansible
#   #       # hosts: python
#   #     become: true  
#   #     apt:
#   #       name: ["python3"]
#   #       state: latest
#   #       update_cache: yes

#   # # Get the environment variables from CircleCI and add to the EC2 instance
#   # # - `ENVIRONMENT`=`production`

#   # environment:
#   #   - TYPEORM_CONNECTION: "{{ lookup('env', 'TYPEORM_CONNECTION')}}"
#   #   - TYPEORM_ENTITIES: "{{ lookup('env', 'TYPEORM_ENTITIES')}}"
#   #   - TYPEORM_HOST: "{{ lookup('env', 'TYPEORM_HOST')}}"
#   #   - TYPEORM_PORT: "{{ lookup('env', 'TYPEORM_PORT')}}"
#   #   - TYPEORM_USERNAME: "{{ lookup('env', 'TYPEORM_USERNAME')}}"
#   #   - TYPEORM_PASSWORD: "{{ lookup('env', 'TYPEORM_PASSWORD')}}"
#   #   - TYPEORM_DATABASE: "{{ lookup('env', 'TYPEORM_DATABASE')}}"
#   #   - TYPEORM_MIGRATIONS: "{{ lookup('env', 'TYPEORM_MIGRATIONS')}}"
#   #   - TYPEORM_MIGRATIONS_DIR: "{{ lookup('env', 'TYPEORM_MIGRATIONS_DIR')}}"

#   #   # Add more env vars here

#   roles:
#     - prometheus_node_exporter
    # - configure_server

    # Your code here   